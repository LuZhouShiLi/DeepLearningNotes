# EQCCT: A production-ready EarthQuake detection and phase picking method using the Compact Convolutional Transformer


## 摘要

* 目标与方法：
论文的目标是提出一种用于地震相到时拾取的紧凑卷积变换器（Compact Convolutional Transformer，CCT），被称为EQCCT。这个方法包含两个分支，分别负责拾取P波和S波的到时。作者使用了STEAD数据集来训练和验证EQCCT算法。

* 数据集和训练：
使用STEAD数据集，将其分为85%用于训练、5%用于验证，以及10%用于测试。为了促进训练过程，作者在训练集上实施了多种数据增强策略，包括添加高斯噪声、随机平移波形、在输入窗口中添加第二个地震事件以及在STEAD数据集的地震图中删除一个或两个通道。

* 性能比较：
EQCCT模型在性能上优于EQTransformer和PhaseNet，这两者是两个最受欢迎的基于深度学习的相位拾取方法。使用真正阳性的标准，即拾取相位与参考时间相差不超过0.5秒，EQCCT在STEAD、Japanese、Instance和Texas数据集上的平均绝对误差（MAE）最低。

* 泛化能力：
EQCCT网络在其他指标（如精度、召回率和F1分数）上也表现出色。作者将预训练模型应用于三个独立的数据集（不包括在训练集中），即Japanese、Texas和Instance数据集，相较于EQTransformer和PhaseNet，在各种统计指标方面都取得了更高的拾取准确度，展示了EQCCT更强的鲁棒性和泛化能力。

* 实时应用：
论文最后提到，在Texas Seismological Network（TexNet）中实时应用EQCCT，展示了其在检测和相位拾取准确度方面的生产就绪性能。



## I. INTRODUCTION

* 高质量的地震目录对于概率地震预测的重要性，而其准确性高度依赖于到时拾取的准确性。尽管数字地震传感器提供了大量数据，但提取所有P波和S波的到时仍然具有挑战性。手动在大数据集上拾取P波和S波的到时是一项耗时的任务，因此强烈需求自动拾取算法以减少拾取过程的时间和成本。

* 传统方法：STA/LTA算法：
传统上，地震检测和相位拾取常常使用STA/LTA算法。这是一种基于能量的算法，通过对地震信号进行短时平均和长时平均的比较来触发地震事件。
    * 算法特点：
STA/LTA算法采用阈值来判断地震的存在。然而，这种基于能量的算法对噪声的敏感性较高，可能导致大量的误报和漏报。

    * 噪声敏感性问题：
文中指出，STA/LTA算法对噪声的敏感性可能导致高误报和漏报的问题。这表明在实际应用中，算法可能难以准确地区分地震信号和噪声。

    * 参数调整问题：
STA/LTA算法的另一个问题是其参数需要为每个特定的地震监测站调整，以获得最佳性能。这一过程是耗时的，并且需要在噪声条件发生变化时进行调整。


* 新模型提出：论文提出了一种新的基于深度学习的模型，即EQCCT，用于地震检测和相位拾取。这一模型的设计基于紧凑卷积变换器（CCT）。

* CCT的通用性：紧凑卷积变换器（CCT）被描述为一种高度通用的模型，能够处理复杂和多变的信号，并在计算机视觉和自然语言处理等多个领域展现出有效性。CCT的通用性表明其在处理不同类型的数据上具有灵活性。

* 模型的不同之处：论文指出，提出的方法与先前的地震相位拾取方法有几个不同之处。首先，采用了CCT架构，结合了卷积神经网络（CNNs）和变换器的优势，可以提取地震图中的重要特征。其次，使用了一种“patching”和嵌入层的方法，更好地捕捉地震图的结构。最后，采用了强大的数据增强策略，包括添加噪声、平移波形、添加第二个地震事件以及删除一个或两个通道，以提高模型的泛化性能。

* 模型设计的亮点：模型设计的亮点包括结合CNNs和变换器的CCT架构、patching和嵌入层的使用，以及强大的数据增强策略，这些都旨在使模型更好地处理复杂的地震信号，并提高在不同数据集上的泛化性能

## II. METHOD

* 即获取与地震的P波和S波到时相对应的样本。采用基于样本的方法来拾取P波和S波的到时，其中输入波形是60秒的三分量地震图（在100 Hz采样率的情况下为6,000个样本），输出的概率与输入的维度相同，即每个输入样本都有一个相应的输出标签。

* 样本级别的拾取方法：
该模型采用样本级别的方法来拾取P波和S波的到时。输入是60秒的三分量地震图，输出是与输入相同维度的概率，即每个输入样本都有相应的输出标签。

* CCT网络的架构：文中展示了采用CCT网络的拾取算法的架构。CCT网络在自然语言处理（NLP）任务中表现出高效性，能够通过为重要信息分配大权重和为其他信息分配小权重的方式，突出显示输入数据中的最重要信息。

* 注意力网络在CCT中的核心作用：在拾取问题中，重要信息是P波和S波的到时。注意力网络是CCT架构中的核心模块，引导网络提取输入数据中P波和S波的位置。

* 独立的P波和S波模型：提出使用两个独立的模型分别拾取P波和S波。每个模型都基于CCT架构，包括Conv块、patching和embedding层以及transformer。这种独立训练的方法可以提高每个任务的性能。

* CCT的特征提取过程：EQCCT通过三个Conv块从输入数据中提取特征。每个Conv块由三个ConvA块和一个dropout层组成，其中每个ConvA块的输入添加到第二个ConvA块的输出（残差连接）。dropout层用于避免过拟合问题。ConvA块包含三个层，即1D卷积层、批量归一化层和ReLU激活函数。P波和S波模型的三个Conv块的特征图数量分别为10、20和40。

* 1D卷积层的核心作用：1D卷积层是ConvA块的核心，输出特征图。

